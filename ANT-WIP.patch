Index: tools/exist/build.xml
===================================================================
--- tools/exist/build.xml	(revision 396)
+++ tools/exist/build.xml	(revision )
@@ -2,7 +2,7 @@
 
     <xmlproperty file="../../build.properties.xml" semanticAttributes="true" keepRoot="false"/>
 
-    <property name="exist.dir" value="/Applications/eXist"/>
+    <property name="exist.dir" value="/Users/dev/Desktop/temp/eXist"/>
     <property name="exist.bfExtension.dir" value="${exist.dir}/extensions/betterform/target/betterform"/>
     <property name="exist.webapp.dir" value="${exist.dir}/webapp"/>
     <property name="tasks.dir" value="/Users/dev/Desktop/task"/>
@@ -20,18 +20,10 @@
         <delete dir="${target.dir}" failonerror="false"/>
     </target>
 
-    <target name="package" depends="create-exist-extension"
-            description="creates a zip archive to be dropped into eXist">
-
-        <ant antfile="${web.dir}/build.xml" target="clean" dir="${web.dir}" inheritall="false"/>
-
-        <ant antfile="${web.dir}/build.xml" target="build-dojo" dir="${web.dir}" inheritall="false">
-                <property name="target.dir" value="${target.dir}"/>
-                <property name="webapp.dir" value="${webapp.dir}"/>
-        </ant>
-
-
+    <target name="cleanup" description="cleans target-dir from unneeded clutter">
         <move file="${webapp.dir}/WEB-INF/betterform-config.xml" todir="${target.dir}"/>
+        <copy file="${webapp.dir}/WEB-INF/classes/META-INF/version.info" todir="${webapp.dir}"/>
+        
         <xslt in="${target.dir}/betterform-config.xml"
               out="${webapp.dir}/WEB-INF/betterform-config.xml"
               force="true"
@@ -39,7 +31,6 @@
             <classpath refid="generator.libs"/>
         </xslt>
 
-
         <delete includeemptydirs="true" failonerror="false">
             <!-- delete forms not relevant for the betterFORM release -->
             <fileset dir="${webapp.dir}/forms/incubator"/>
@@ -66,32 +57,63 @@
                                                                activation-* ,
                                                                mail-*" />
         </delete>
+    </target>
 
+    <target name="package" depends="create-exist-extension" description="creates a zip archive used by the extension-installer ant-file">
+        <ant antfile="${web.dir}/build.xml" target="clean" dir="${web.dir}" inheritall="false"/>
+        <ant antfile="${web.dir}/build.xml" target="build-dojo" dir="${web.dir}" inheritall="false">
+                <property name="target.dir" value="${target.dir}"/>
+                <property name="webapp.dir" value="${webapp.dir}"/>
+        </ant>
+        <antcall target="cleanup"/>
         <zip basedir="${webapp.dir}" zipfile="${webapp.dir}-3.0.0.zip"/>
-
-
-
     </target>
 
-    <target name="create-exist-extension">
+    <target name="create-exist-extension" description="creates a zip archive of the eXist-extension installer">
         <mkdir dir="${target.dir}/exist"/> 
       <zip basedir="${basedir}/betterform" zipfile="${target.dir}/exist/betterform.zip"/>
     </target>
 
-    <target name="deploy-into-installed-eXist" depends="package" description="copies betterFORM 'forms', 'resources' and 'Java classes' to the configured eXist xml db">
+    <target name="deploy-into-installed-eXist" description="copies betterFORM 'forms', 'resources' and 'Java classes' to the configured eXist xml db">
+         <available property="extensionInstalled" file="${exist.bfExtension.dir}/target/betterform/version.info"/>
+    </target>
 
-        <copy todir="${exist.webapp.dir}/forms">
-            <fileset dir="${webapp.dir}/forms"/>
+    <target name="install-into-eXist" unless="extensionInstalled">
+        <copy file="${web.dir}/src/main/resources/META-INF/version.info" todir="${exist.bfExtension.dir}"/>
+
+        <ant antfile="${web.dir}/build.xml" target="compile" dir="${web.dir}" inheritall="false">
+                <property name="target.dir" value="${target.dir}"/>
+                <property name="webapp.dir" value="${webapp.dir}"/>
+        </ant>
+
+        <copy todir="${exist.webapp.dir}/forms" overwrite="true">
+            <fileset dir="../../src/main/xforms"/>
         </copy>
 
         <copy todir="${exist.webapp.dir}/resources">
-            <fileset dir="${webapp.dir}/resources"/>
+            <fileset dir="../../src/main/resources"/>
         </copy>
 
-        <delete  dir="${exist.bfExtension.dir}/WEB-INF/classes"/>
-        <copy todir="${exist.bfExtension.dir}/WEB-INF/classes">
-            <fileset dir="${webapp.dir}/WEB-INF/classes"/>
+        <copy description="copy images seperately to avoid filtering"
+              todir="${webapp.dir}/resources"
+              overwrite="true"
+              filtering="false">
+            <fileset dir="../../src/main/resources">
+                <include name="**/*.gif"/>
+                <include name="**/*.png"/>
+                <include name="**/*.jpg"/>
+            </fileset>
         </copy>
+
+        <!-- copy core classes -->
+        <copy todir="${exist.bfExtension.dir}/WEB-INF/classes" overwrite="true">
+            <fileset dir="${core.dir}/target/classes"/>
+        </copy>
+
+        <!-- copy web classes -->
+        <copy todir="${exist.bfExtension.dir}/WEB-INF/classes" overwrite="true">
+            <fileset dir="${web.dir}/target/classes"/>
+        </copy>
     </target>
 
     <!--
Index: core/build.xml
===================================================================
--- core/build.xml	(revision 350)
+++ core/build.xml	(revision )
@@ -80,8 +80,8 @@
 
         <echo>SVN Revision ${Revision}</echo>
 -->
-        <filter token="app.name" value="${core.app.name}"/>
-        <filter token="app.version" value="${core.app.version}"/>
+        <filter token="app.name" value="${web.app.name}"/>
+        <filter token="app.version" value="${web.app.version}"/>
         <filter token="app.build" value="${DSTAMP}/${TSTAMP}"/>
         <!-- <filter token="revision.number" value="${Revision}"/> -->
 
