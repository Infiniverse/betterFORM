<link rel="import" href="fore-instance.html">

<polymer-element name="fore-xml-instance" extends="fore-instance" attributes="data">
<!--
    <template>
        <fore-node name="foo">
            <fore-property name="readonly">false</fore-node>
            <fore-property name="required">false</fore-node>
            <fore-property name="value">the content of this node</fore-property>
            <fore-property name="myProp">custom property</fore-property>
            <fore-node>
                ....
            </fore-node>
        </fore-node>
    </template>
-->

    <script>

        Polymer('fore-xml-instance', {
            dataformat:'xml',

            ready: function () {
                console.log("#### FORE-XML-INSTANCE :: ready()");        
                this.super();
                this.itemStates = [];
            },
            enteredView: function () {
                console.log("#### FORE-XML-INSTANCE :: enteredView()");        
                this.super();
            },

            /** @Override */
            getValue: function(path) {
                var cssPath = path.replace(/\./g, ' ');
                var myValue = this.querySelector(cssPath);
                //console.log("#### FORE-XML-INSTANCE :: getValue()");
                //console.log("#### FORE-XML-INSTANCE :: CSSPath:" , cssPath);
                //console.log("#### FORE-XML-INSTANCE :: myValue", myValue);

                return myValue.textContent;
            },

            /** @Override */
            setValue: function(path, value) {
                var cssPath = path.replace(/\./g, ' ');
                var myValue = this.querySelector(cssPath);

                console.log("#### FORE-XML-INSTANCE :: setValue()");
                console.log("#### FORE-XML-INSTANCE :: CSSPath:" , cssPath);
                console.log("#### FORE-XML-INSTANCE :: value", value);
                console.log("#### FORE-XML-INSTANCE :: myValue", myValue);

                myValue.textContent = value;
                this.itemStates[path].value = value;
            },

            /** @Override */
            getItem: function(path) {
                var cssPath = path.replace(/\./g, ' ');
                var item = this.querySelector(cssPath);

                var state = 'NO NO'
                if(this.itemStates[path] === undefined) {
                    state = new State();
                    console.log("#### FORE-XML-INSTANCE :: State:" , state);
                    state.value = this.getValue(path);
                    this.itemStates[path] = state;
                }
                //console.log("#### FORE-XML-INSTANCE :: getItem()");
                //console.log("#### FORE-XML-INSTANCE :: CSSPath:" , cssPath);
                console.log("#### FORE-XML-INSTANCE :: ItemStates:" , this.itemStates);
                return this.itemStates[path];
            }

            });
    </script>
</polymer-element>